<!DOCTYPE html>  
<html lang="en" xmlns:th="http://www.thymeleaf.org">  
<head>  
    <meta charset="UTF-8"/>  
    <title>斯迈夫用户注册</title> 
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="https://cdn.bootcss.com/weui/1.1.2/style/weui.min.css" />
	<link rel="stylesheet" href="https://cdn.bootcss.com/jquery-weui/1.2.0/css/jquery-weui.min.css" />
	<link rel="stylesheet" href="register.css" />
</head>
<body>

	<div class="step weui-flex">
		<div class="on weui-flex__item">
			<span class="num"><em class="f-r5"></em><i>1</i></span> <span
				class="line_bg lbg-r"></span>
			<p class="lbg-txt">填写基本信息</p>
		</div>
		<div class="weui-flex__item">
			<span class="num"><em class="f-r5"></em><i>2</i></span> <span
				class="line_bg lbg-l"></span> <span class="line_bg lbg-r"></span>
			<p class="lbg-txt">绑定票号</p>
		</div>
		<div class="weui-flex__item">
			<span class="num"><em class="f-r5"></em><i>3</i></span> <span
				class="line_bg lbg-l"></span>
			<p class="lbg-txt">获取电子票</p>
		</div>
	</div>


	<div class="part_content">
	<div class="part1 weui-cells weui-cells_form">
		<div id="name_div" class="weui-cell item">
			<div class="weui-cell__hd">
				<span class="intelligent-label f-fl"><b class="ftx04">*</b></span> <label
					class="weui-label">姓　名:</label>
			</div>
			<div class="weui-cell__bd">
				<input id="name_input" class="weui-input" type="text"
					placeholder="请输入您的姓名" />
			</div>
			<div class="weui-cell__ft">
				<i class="weui-icon-warn"></i>
			</div>
		</div>

		<div id="phone_div" class="weui-cell weui-cell_vcode item">
			<div class="weui-cell__hd">
				<span class="intelligent-label f-fl"><b class="ftx04">*</b></span> <label
					class="weui-label">手　机:</label>
			</div>
			<div class="weui-cell__bd">
				<input id="phone_call" class="weui-input" type="tel"
					placeholder="请输入您的手机号" />
			</div>
			<div class="weui-cell__ft">
				<i class="weui-icon-warn"></i>
			</div>
		</div>

		<div id="company_div" class="weui-cell item">
			<div class="weui-cell__hd">
				<span class="intelligent-label f-fl"><b class="ftx04">*</b></span> <label
					class="weui-label">公　司:</label>
			</div>
			<div class="weui-cell__bd">
				<input id="company_input" class="weui-input" type="text" value=""
					placeholder="请输入您的公司名称" />
			</div>
			<div class="weui-cell__ft">
				<i class="weui-icon-warn"></i>
			</div>
		</div>
		<div id="duty_div" class="weui-cell item">
			<div class="weui-cell__hd">
				<span class="intelligent-label f-fl"><b class="ftx04">*</b></span> <label
					class="weui-label">职　务:</label>
			</div>
			<div class="weui-cell__bd">
				<input id="duty_input" class="weui-input" type="text" value=""
					placeholder="请输入您的职务" />
			</div>
			<div class="weui-cell__ft">
				<i class="weui-icon-warn"></i>
			</div>
		</div>

		<a href="javascript:;" class="weui-btn weui-btn_primary next">下一步</a>
	</div>

	<div class="part2 weui-cells">
		<div class="item weui-cell" style="margin-top: 20px;">
			<div class="weui-cell__hd">
				<span class="intelligent-label f-fl"><b class="ftx04">*</b></span> <label
					class="weui-label">票&nbsp;&nbsp;&nbsp;号：</label>
			</div>
			<div class="weui-cell__bd">
				<input id="ticket_input" class="weui-input" type="text" value=""
					placeholder="请输入票号" />
			</div>
		</div>
		<div class="item weui-cell">
			<div class="weui-cell__hd">
				<span class="intelligent-label f-fl"><b class="ftx04">*</b></span> <label
					class="weui-label">手机号:</label>
			</div>
			<div class="weui-cell__bd">
				<input id="" class="weui-input" type="text" value="15824450934" disabled="true" style="background: #f9f9f9;width: 80%"/>
			</div>
			<div class="weui-cell__ft">
				<span class="weui-btn weui-btn_primary part2-code" id="verifyYz">发送验证码</span>
			</div>
		</div>
		<div class="item weui-cell weui-cell_vcode" id="part2-item">
			<div class="weui-cell__hd">
				<span class="intelligent-label f-fl"><b class="ftx04">*</b></span> <label
					class="weui-label">验证码:</label>
			</div>

			<div class="weui-cell__bd">
				<input class="weui-input" type="number" placeholder="请输入验证码" />
			</div>
		</div>
		<label class="focus"><span>请查收手机短信，并填写短信中的验证码（此验证码3分钟内有效）</span></label>
		<div class="btn">
			<a href="javascript:;" class="weui-btn weui-btn_primary forwardBtn">上一步</a>
			<a href="javascript:;" class="weui-btn weui-btn_primary registerBtn">注册</a>
		</div>

	</div>


	<div class="weui-msg__text-area part3">
		<h2 class="weui-msg__title">恭喜cz82465，您已注册成功，现在开始您的投资之旅吧！</h2>
		<!--<p class="weui-msg__desc">页面将在<strong id="times" class="f-size18">10</strong> 秒钟后，跳转到<a href="javascript:void(0);">用户中心</a></p>-->
	</div>
	</div>
	<script src="https://cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script>
	<script src="https://cdn.bootcss.com/jquery-weui/1.2.0/js/jquery-weui.min.js"></script>

</body>
<script src="register.js"></script>

<script th:inline="javascript">
	$("input").change(function() {
		$(this).parent().parent().removeClass("weui-cell_warn");
	});

	function sendCode() {
		var second = 60;
		$("#getCode").attr("disabled", true);
		$.get("user/code/" + $("#phone_call").val().trim(), function(data) {
			console.log(data);
		});
		var _interval = setInterval(function() {
			$("#getCode").text("获取验证码(" + --second + ")");
			if (0 >= second) {
				clearInterval(_interval);
				$("#getCode").attr("disabled", false);
				$("#getCode").text("获取验证码");
			}
		}, 1000);
	};
	function doRegist() {
		if (0 >= $("#name_input").val().trim().length) {
			$("#name_div").addClass("weui-cell_warn");
			$(".none").eq(0).css("display", "none");
			return;
		}
		if (0 >= $("#phone_call").val().trim().length) {
			$("#phone_div").addClass("weui-cell_warn");
			$(".none").eq(1).css("display", "none");
			return;
		}
		if (0 >= $("#company_input").val().trim().length) {
			$("#company_div").addClass("weui-cell_warn");
			$(".none").eq(2).css("display", "none");
			return;
		}
		if (0 >= $("#duty_input").val().trim().length) {
			$("#duty_div").addClass("weui-cell_warn");
			$(".none").eq(3).css("display", "none");
			return;
		}
		if (0 >= $("#phoneCode_input").val().trim().length) {
			$("#phoneCode_div").addClass("weui-cell_warn");
			return;
		}
		/*<![CDATA[*/
		$.ajax({
			url : 'user/validateCode?phoneNum=' + $("#phone_call").val().trim()
					+ '&code=' + $("#phoneCode_input").val().trim(),
			type : 'GET',
			dataType : 'json',
			contentType : "application/json; charset=utf-8",
			data : {},
			error : function(data) {
				console.log(data)
			},
			success : function(data) {
				if (data.result.data == 'yes') {
					var userBean = {
						name : $("#name_input").val().trim(),
						phone : $("#phone_call").val().trim(),
						company : $("#company_input").val().trim(),
						duty : $("#duty_input").val().trim(),

					};
					$.ajax({
						url : 'user/register',
						type : 'PUT',
						dataType : 'json',
						contentType : "application/json; charset=utf-8",
						data : JSON.stringify(userBean),
						error : function(data) {
							console.log(data)
						},
						success : function(data) {
							//提示注册成功
						}
					});
				} else {
					//提示验证码不正确
				}
			}
		});
		/*]]>*/
	}
</script>
  
</html>